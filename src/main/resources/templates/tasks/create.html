<!DOCTYPE html>
<html lang="en">
    <head>
        <th:block th:replace="~{partials/partials :: head(title= 'Submit A Task')}">
          <link rel="stylesheet" th:href="@{/css/createTasks.css}">
        </th:block>
    </head>
    <body>
      <nav th:insert="~{partials/partials :: navbar}" id="navBar"></nav>
      <h1>Create Task</h1>


      <form th:action="@{/tasks/create}" th:method="POST" th:object="${tasker}">
        <label for="title">Title</label>
        <input th:field="*{title}" id="titleInput" required>
        <br>
        <br>
        <label for="description" id="desc">Description</label>
        <!-- <input th:field="*{description}"> -->
        <textarea cols="30" rows="10" th:field="*{description}" id="descriptionInput" required></textarea>
        <br>
        <br>
        <fieldset  id="cici">
          <legend>Categories:</legend>

          <div th:each="c : ${cat}">
            <label th:for="${c.name}">[[${c.name}]]</label>
            <input type="checkbox" name="cater" th:id="${c.name}" th:value="${c.getName()}" class="checker" data-toggle="toggle">
            <!-- <span th:text="${c.getName()}"></span> -->
          </div>

          <!-- <span th:text="cat.getName()"></span> -->
        </fieldset>
        <input type="submit" id="sobmit">
      </form>
              <!-- <a th:href="@{/tasks/addCategory}" id="blah">Add Category</a> -->
          <fieldset>
              <button type="button" id="hiddenForm">Add Cat</button>
                <div hidden id="removeHidden">
                  <h1>Add New Category</h1>
                  <form
                  th:action="@{/tasks/create}"
                  th:method="POST"
                  th:object="${newCat}"
                  >

                    <label for="name"></label>
                    <input th:field="*{name}" id="catName" required/>
                    <!-- <button type="submit">Sub Cat</button> -->
                     <input type="submit" value="Sobmyt" id="submitCategory">
                    <button type="reset" id="cancelCreateCat">Cancel</button>
                  </form>
                </div>

          </fieldset>
      <br>



<script>
  const removeHiddenAttribute = document.getElementById("hiddenForm");
  const grabTitleInput = document.getElementById("titleInput");
  const grabDescriptionInput = document.getElementById("descriptionInput");


  removeHiddenAttribute.addEventListener('click', () => {
    if('click'){
      document.getElementById("removeHidden").hidden = false;
      sessionStorage.setItem('title', grabTitleInput.value);
      sessionStorage.setItem('description', grabDescriptionInput.value);
    }
  });

  const addHiddenAttribute = document.getElementById("cancelCreateCat");
  addHiddenAttribute.addEventListener('click', () =>{
    if('click'){
      document.getElementById("removeHidden").hidden = true;
    }
  });

  const submitCategoryButton = document.getElementById("submitCategory");
  function submitCategoryButtonListener () {
    submitCategoryButton.addEventListener('click', ()=>{})
  };
  if(submitCategoryButtonListener){
    grabTitleInput.value = sessionStorage.getItem('title');
    grabDescriptionInput.value = sessionStorage.getItem('description');
  };

  const newCategoryName = document.getElementById('catName');
  if(submitCategoryButtonListener){
    newCategoryName.addEventListener('keyup', ()=>{
      const keyUpNewCategory = newCategoryName.value;
      sessionStorage.setItem('newCategory', keyUpNewCategory);
    })
  }

  const grabAllChildElements = document.getElementById('cici').children;
  let u = document.getElementById('cici')
  console.log(u)
  for(let i = 1; i < grabAllChildElements.length; i++){
    let categoryName = grabAllChildElements[i].children[1].id;
    // console.log("??? " +i)
    newCategoryName.value = sessionStorage.getItem('newCategory');
    if(newCategoryName.value == categoryName){
      // console.log("ID name: " +categoryName)
      document.getElementById(categoryName).checked = true;
    }
  }

  // console.log(grabAllChildElements.length)
  const x = document.getElementsByName("cater")
  // console.log(x.length)

  var checkbox = document.querySelector("input[name=cater]");
  // console.log("c")
  // console.log(checkbox)

checkbox.addEventListener('change', function() {
  if (this.checked) {
    console.log("Checkbox is checked..");
  } else {
    console.log("Checkbox is not checked..");
  }
});

  for(let i = 0; i < x.length; i++){
  const getNames = document.getElementsByName("cater")[i]
  // console.log(i)
  // console.log(x)
  // console.log(x[i])
  let b = x[i].id
  // console.log(b)
//   b.addEventListener.addEventListener('change', function() {
//     console.log(b)
//   if (this.checked) {
//     console.log("Checkbox is checked..");
//   } else {
//     console.log("Checkbox is not checked..");
//   }
// });
  }
  for(i of x){
    console.log(i)
    i.addEventListener('change', function() {
  if (this.checked) {
    console.log("Checkbox is checked..");
  } else {
    console.log("Checkbox is not checked..");
  }
});
  }

  const partialsNavBar = document.getElementById('navBar');
  const createTaskSubmitButton = document.getElementById('sobmit');
  function navBarListener() {
    partialsNavBar.addEventListener('click', ()=>{})
  };
  function createTaskListener() {
    createFormSubmitButton.addEventListener('click', ()=>{})
  };
  if(navBarListener){
    sessionStorage.clear();
  };
  if(createTaskListener){
    sessionStorage.clear();
  }
</script>

    </body>
</html>